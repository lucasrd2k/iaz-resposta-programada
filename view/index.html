<!DOCTYPE html>
<html style="font-size: 16px;">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="keywords" content="WhatsApp API &amp;amp; IAZ">
  <meta name="description" content="">
  <meta name="page_type" content="np-template-header-footer-from-plugin">
  <title>IAZ-Multiple Configuração - WhatsApp API</title>
  <link rel="stylesheet" href="view/zdg2.css" media="screen">
  <link rel="stylesheet" href="view/zdg.css" media="screen">
  <link rel="icon" type="image/x-icon" href="images/icon.ico">
  <script class="u-script" type="text/javascript" src="view/jquery.js" defer=""></script>
  <script class="u-script" type="text/javascript" src="view/zdg.js" defer=""></script>
  <meta name="generator" content="IAZ, ia-z.online/">
  <link id="u-theme-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i|Open+Sans:300,300i,400,400i,500,500i,600,600i,700,700i,800,800i">
  <link id="u-page-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i|PT+Sans:400,400i,700,700i|Lalezar:400">
  <script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "",
        "logo": "#"
        }
        </script>
  <meta name="theme-color" content="#2e937a">
  <meta property="og:title" content="Página Inicial">
  <meta property="og:type" content="website">
  <style>
    #userContent {
      width: 80%;
      margin: 0 auto;
    }

    #userContent table {
      width: 100%;
    }
  </style>
</head>

<body data-home-page="Página-Inicial.html" data-home-page-title="Página Inicial" class="u-body u-xl-mode">
  <header class="u-clearfix u-header u-header" id="sec-84ba">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <br>
      <br>
      <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1" data-responsive-from="XL">
        <div class="menu-collapse" style="font-size: 1rem; letter-spacing: 0px; font-weight: 500;" wfd-invisible="true">
          <a class="u-button-style u-custom-active-color u-custom-border u-custom-border-color u-custom-hover-color u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base"
            href="#">
            <svg class="u-svg-link" viewBox="0 0 24 24">
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
            </svg>
            <svg class="u-svg-content" version="1.1" id="menu-hamburger" viewBox="0 0 16 16" x="0px" y="0px"
              xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
              <g>
                <rect y="1" width="16" height="2"></rect>
                <rect y="7" width="16" height="2"></rect>
                <rect y="13" width="16" height="2"></rect>
              </g>
            </svg>
          </a>
        </div>
        <div class="u-nav-container" wfd-invisible="true">
          <ul class="u-nav u-spacing-2 u-unstyled u-nav-1">
            <li class="u-nav-item"><a
                class="u-active-grey-5 u-button-style u-hover-grey-10 u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90"
                href="#instruct" style="padding: 10px 20px;">Alterar instrução</a>
            </li>
            <li class="u-nav-item"><a
                class="u-active-grey-5 u-button-style u-hover-grey-10 u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90"
                href="#inicio" style="padding: 10px 20px;">Inicio</a>
            </li>
            <li class="u-nav-item"><a
                class="u-active-grey-5 u-button-style u-hover-grey-10 u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90"
                href="#app" style="padding: 10px 20px;">API Logs</a>
            </li>
            <li class="u-nav-item"><a
                class="u-active-grey-5 u-button-style u-hover-grey-10 u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90"
                href="#notificacao" style="padding: 10px 20px;">Envio de mensagens</a>
            </li>
            <li class="u-nav-item"><a
                class="u-active-grey-5 u-button-style u-hover-grey-10 u-nav-link u-text-active-grey-90 u-text-grey-90 u-text-hover-grey-90"
                href="#usuarios" style="padding: 10px 20px;">Usuários</a>
            </li>

          </ul>
        </div>
        <div class="u-nav-container-collapse" wfd-invisible="true">
          <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
            <div class="u-inner-container-layout u-sidenav-overflow">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="#instruct"
                    style="padding: 10px 20px;">Alterar instrução</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="#inicio"
                    style="padding: 10px 20px;">Iniciar</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="#app"
                    style="padding: 10px 20px;">Logs</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="#notificacao"
                    style="padding: 10px 20px;">Envio de mensagens</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="#usuarios"
                    style="padding: 10px 20px;">Usuários</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="u-black u-menu-overlay u-opacity u-opacity-70" wfd-invisible="true"></div>
        </div>
      </nav>
    </div>
  </header>
  <!-- Essa seção é pra ver e alterar a instrução do bot -->
  <section class="u-align-center u-clearfix u-palette-3-light-2 u-section-1" id="instruct">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div class="u-clearfix u-expanded-width-sm u-expanded-width-xs u-gutter-0 u-layout-wrap u-layout-wrap-1">
        <div class="u-gutter-0 u-layout">
          <div class="u-layout-row">
            <div class="u-align-left u-container-style u-layout-cell u-size-30 u-white u-layout-cell-1">
              <div class="u-container-layout u-valign-middle u-container-layout-1">
                <div id="botContainer" style="display: flex; flex-wrap: wrap; margin-bottom: 10px;">
                  <!-- Aqui vão os botões -->
                </div>
                <h6 class="u-text u-text-default u-text-grey-50 u-text-1">IAZ-Multiple</h6>
                <h2 class="u-custom-font u-font-source-sans-pro u-text u-text-2">WhatsApp API</h2>
                <label for="instanceName" id="instanceLabel" style="display: none;">Nome da instância:</label>
                <input type="text" id="instanceName" style="display:none;" class="u-border-1 u-border-grey-30 u-input u-input-rectangle u-white u-input-1">
                <label for="instructionTextArea">Instrução:</label>
                <textarea id="instructionTextArea" style="width: 100%; height: 150px;"></textarea>
    
                <!-- Campos ocultos -->
                <input type="hidden" id="isNew" value="false">
                <input type="hidden" id="instanceId">
    
                <div style="display: flex;">
                  <button onclick="submitInstruction()" id="botaoSubmit" class="u-btn u-button-style u-palette-1-base">Alterar Instrução</button>
                  <button onclick="toggleInstanceNameVisibility()" id="novoBotao" class="u-btn u-button-style u-palette-1-base" style="margin-left: 10px;">Novo bot</button>
                  <button onclick="deleteBot()" id="deleteBotButton" class="u-btn u-button-style u-palette-1-base" style="margin-left: 10px;">Excluir bot</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <script>
      function deleteBot() {
        const instanceId = document.getElementById('instanceId').value;
        const instanceName = document.getElementById('instanceName').value;

        if (confirm(`Tem certeza que deseja excluir o bot ${instanceName}?`)) {
          fetch('/bots/' + instanceId, {
            method: 'DELETE'
          })
            .then(response => response.json())
            .then(data => {
              if (data.status) {
                alert('Bot excluído com sucesso!');
                window.location.reload();
              }
            })
            .catch(error => {
              console.error('Erro ao excluir o bot:', error);
            });
        }
      }

      function toggleInstanceNameVisibility() { // essa função é chamada quando o botão "Novo bot" é clicado
        console.log('Toggling instance name visibility');
        const instanceNameField = document.getElementById('instanceName');
        const instanceLabel = document.getElementById('instanceLabel');
        instanceLabel.style.display = 'block';
        instanceNameField.style.display = 'block';
        document.getElementById('isNew').value = 'true';
        // Esconder o botão "Deletar bot"
        document.getElementById('deleteBotButton').style.display = 'none';
        // Esconder o botão "Novo bot"
        document.getElementById('novoBotao').style.display = 'none';

        // Alterar o texto do botão "Alterar Instrução" para "Cadastrar Bot"
        document.getElementById('botaoSubmit').innerText = 'Cadastrar Bot';
      }


      function submitInstruction() {
        const instructionContent = document.getElementById('instructionTextArea').value;
        const isNew = document.getElementById('isNew').value === 'true';
        const instanceName = document.getElementById('instanceName').value;
        const instanceId = document.getElementById('instanceId').value;

        fetch('/instrucao', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            instruction: instructionContent,
            novo: isNew,
            nome: instanceName,
            id: instanceId
          })
        })
          .then(response => response.json())
          .then(data => {
            console.log(data);
            if (isNew) {
              alert("Bot cadastrado com sucesso!");
              window.location.reload();
            }
            else {
              alert("Instrução alterada com sucesso!");
            }
          });
      }

      function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }

      function buscarInstrucao() {
        // Pegar o ID da URL. Se não existir, usar 1 como padrão.
        const id = getParameterByName('id') || 1;

        // Busque a instrução atual com o ID fornecido
        fetch('/instrucao/' + id)
          .then(response => {
            if (!response.ok) {
              throw new Error('Erro de rede');
            }
            return response.json();
          })
          .then(data => {
            document.getElementById('instructionTextArea').value = data.instruction;
          })
          .catch(error => {
            console.error('Erro ao buscar instrução:', error);
            toggleInstanceNameVisibility();
          });

      }

      // Chamar a função quando a página carregar

      //Quando iniciar a página, buscar o parametro get id e adicionar no campo instanceId
      window.onload = function () {
        //buscarInstrucao();
        const id = getParameterByName('id') || 1;
        document.getElementById('instanceId').value = id;

        fetch('/bots')
          .then(response => response.json())
          .then(data => {
            if (data.status) {
              const botContainer = document.getElementById('botContainer');
              // Remover qualquer conteúdo existente
              botContainer.innerHTML = '';

              // Criar um botão para cada bot
              counter = 0;
              data.systems.forEach(system => {
                //se o counter == 3 então pula uma linha
                if (counter == 3) {
                  botContainer.innerHTML += '<br>';
                  counter = 0;
                }
                counter++;
                const button = document.createElement('button');

                // Definir a instância como o texto do botão
                button.textContent = system.instancia;

                // Adicionar classes ao botão
                button.classList.add('u-btn', 'u-button-style', 'u-palette-1-base');

                //adicionar margem esquerda de 5px
                button.style.marginLeft = '5px';

                // Adicionar um parâmetro GET com o ID ao botão
                button.addEventListener('click', () => {
                  window.location.href = `?id=${system.id}`;
                });

                // Adicionar o botão ao container
                botContainer.appendChild(button);
              });
            }
          })
          .catch(error => {
            console.error('Erro ao buscar os bots:', error);
          });
      }
      // Fazer uma requisição GET para buscar todos os bots





    </script>
  </section>
  <section class="u-align-center u-clearfix u-palette-3-light-2 u-section-1" id="inicio">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div class="u-clearfix u-expanded-width-sm u-expanded-width-xs u-gutter-0 u-layout-wrap u-layout-wrap-1">
        <div class="u-gutter-0 u-layout">
          <div class="u-layout-row">
            <div class="u-align-left u-container-style u-layout-cell u-size-30 u-white u-layout-cell-1">
              <div class="u-container-layout u-valign-middle u-container-layout-1">
                <h6 class="u-text u-text-default u-text-grey-50 u-text-1">IAZ-Multiple</h6>
                <h2 class="u-custom-font u-font-source-sans-pro u-text u-text-2">WhatsApp API</h2>
                <ul class="u-custom-list u-text u-text-3">
                  <li>
                    <div class="u-list-icon u-text-palette-2-base">
                      <svg class="u-svg-content" viewBox="0 0 415.994 415.994" id="svg-aeac"
                        style="font-size: 0.5em; margin: -0.5em;">
                        <path
                          d="m391.645 193.946-352-192c-4.96-2.688-10.976-2.592-15.808.288-4.864 2.88-7.84 8.128-7.84 13.76v384c0 5.664 2.976 10.88 7.84 13.76 2.496 1.504 5.344 2.24 8.16 2.24 2.656 0 5.28-.672 7.648-1.984l352-192c5.152-2.752 8.352-8.16 8.352-14.016s-3.2-11.264-8.352-14.048z"
                          fill="currentColor"></path>
                      </svg>
                    </div> Conectada ao chat gpt-3.5-turbo-16k
                  </li>
                  <li>
                    <div class="u-list-icon u-text-palette-2-base">
                      <svg class="u-svg-content" viewBox="0 0 415.994 415.994" id="svg-aeac"
                        style="font-size: 0.5em; margin: -0.5em;">
                        <path
                          d="m391.645 193.946-352-192c-4.96-2.688-10.976-2.592-15.808.288-4.864 2.88-7.84 8.128-7.84 13.76v384c0 5.664 2.976 10.88 7.84 13.76 2.496 1.504 5.344 2.24 8.16 2.24 2.656 0 5.28-.672 7.648-1.984l352-192c5.152-2.752 8.352-8.16 8.352-14.016s-3.2-11.264-8.352-14.048z"
                          fill="currentColor"></path>
                      </svg>
                    </div>Escaneie o código e comece a usar
                  </li>
                  <li>
                    <div class="u-list-icon u-text-palette-2-base">
                      <svg class="u-svg-content" viewBox="0 0 415.994 415.994" id="svg-aeac"
                        style="font-size: 0.5em; margin: -0.5em;">
                        <path
                          d="m391.645 193.946-352-192c-4.96-2.688-10.976-2.592-15.808.288-4.864 2.88-7.84 8.128-7.84 13.76v384c0 5.664 2.976 10.88 7.84 13.76 2.496 1.504 5.344 2.24 8.16 2.24 2.656 0 5.28-.672 7.648-1.984l352-192c5.152-2.752 8.352-8.16 8.352-14.016s-3.2-11.264-8.352-14.048z"
                          fill="currentColor"></path>
                      </svg>
                    </div>Crie novos bots e altere suas instruções
                  </li>
                  <li>
                    <div class="u-list-icon u-text-palette-2-base">
                      <svg class="u-svg-content" viewBox="0 0 415.994 415.994" id="svg-aeac"
                        style="font-size: 0.5em; margin: -0.5em;">
                        <path
                          d="m391.645 193.946-352-192c-4.96-2.688-10.976-2.592-15.808.288-4.864 2.88-7.84 8.128-7.84 13.76v384c0 5.664 2.976 10.88 7.84 13.76 2.496 1.504 5.344 2.24 8.16 2.24 2.656 0 5.28-.672 7.648-1.984l352-192c5.152-2.752 8.352-8.16 8.352-14.016s-3.2-11.264-8.352-14.048z"
                          fill="currentColor"></path>
                      </svg>
                    </div>Clique no botão abaixo para iniciar
                  </li>
                </ul>
                <a href="#app"
                  class="u-active-grey-80 u-border-none u-btn u-btn-round u-button-style u-hover-grey-80 u-palette-1-base u-radius-10 u-btn-1">INICIAR
                </a>
              </div>
            </div>
            <div
              class="u-container-style u-layout-cell u-palette-3-light-3 u-shape-rectangle u-size-30 u-layout-cell-2">
              <div class="u-container-layout u-valign-bottom u-container-layout-2">
                <img class="u-expanded-width-lg u-expanded-width-md u-expanded-width-xl u-image u-image-1"
                  src="images/cv-min.png" data-image-width="617" data-image-height="723">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="u-align-center u-clearfix u-palette-3-light-2 u-section-2" id="app">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div id="app">
        <img src="" alt="QR Code" id="qrcode">
        <h3>Logs de Conexão:</h3>
        <p class="logs"></p>
      </div>

    </div>
  </section>
  <section class="u-clearfix u-section-5" id="notificacao">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div class="u-clearfix u-expanded-width u-gutter-20 u-layout-wrap u-layout-wrap-1">
        <div class="u-layout">
          <div class="u-layout-row">
            <div
              class="u-container-style u-layout-cell u-opacity u-opacity-40 u-palette-4-light-2 u-radius-20 u-shape-round u-size-30 u-layout-cell-1">
              <div class="u-container-layout u-valign-middle u-container-layout-1">
                <h5 class="u-custom-font u-font-source-sans-pro u-text u-text-default u-text-palette-4-base u-text-1">
                  POST Mensagem</h5>
                <h2 class="u-custom-font u-font-source-sans-pro u-text u-text-2">Envie mensagens de texto</h2>
                <p>
                <h4>Headers</h4>content-type: application/x-www-form-urlencoded<br>
                <h4>Body</h4>number: 55**********<br>message: Mensagem a ser enviada</p>
                <p></p>
                <a href="#"
                  class="u-border-1 u-border-active-palette-4-light-1 u-border-hover-palette-4-base u-btn u-button-style u-none u-text-palette-4-base u-btn-1">Saiba
                  mais&nbsp;&nbsp;<span class="u-icon u-icon-1"><svg class="u-svg-content" viewBox="0 0 512 512" x="0px"
                      y="0px" style="width: 1em; height: 1em;">
                      <g>
                        <g>
                          <path
                            d="M506.134,241.843c-0.006-0.006-0.011-0.013-0.018-0.019l-104.504-104c-7.829-7.791-20.492-7.762-28.285,0.068    c-7.792,7.829-7.762,20.492,0.067,28.284L443.558,236H20c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h423.557    l-70.162,69.824c-7.829,7.792-7.859,20.455-0.067,28.284c7.793,7.831,20.457,7.858,28.285,0.068l104.504-104    c0.006-0.006,0.011-0.013,0.018-0.019C513.968,262.339,513.943,249.635,506.134,241.843z">
                          </path>
                        </g>
                      </g>
                    </svg><img></span>
                </a>
              </div>
            </div>
            <div
              class="u-container-style u-layout-cell u-opacity u-opacity-75 u-palette-3-light-2 u-radius-20 u-size-30 u-layout-cell-2">
              <div class="u-container-layout u-valign-middle u-container-layout-2">
                <h5 class="u-custom-font u-font-source-sans-pro u-text u-text-default u-text-palette-1-base u-text-3">
                  POST Arquivo</h5>
                <h2 class="u-custom-font u-font-source-sans-pro u-text u-text-4">Envie mídias e arquivos</h2>
                <p>
                <h4>Headers</h4>content-type: application/x-www-form-urlencoded<br>
                <h4>Body</h4>number: 55**********<br>file: url do arquivo<br>caption: título do arquivo</p>
                <a href="#"
                  class="u-border-1 u-border-active-palette-3-light-1 u-border-hover-palette-1-base u-btn u-button-style u-none u-text-palette-1-base u-btn-2">Saiba
                  mais&nbsp;&nbsp;<span class="u-icon u-icon-2"><svg class="u-svg-content" viewBox="0 0 512 512" x="0px"
                      y="0px" style="width: 1em; height: 1em;">
                      <g>
                        <g>
                          <path
                            d="M506.134,241.843c-0.006-0.006-0.011-0.013-0.018-0.019l-104.504-104c-7.829-7.791-20.492-7.762-28.285,0.068    c-7.792,7.829-7.762,20.492,0.067,28.284L443.558,236H20c-11.046,0-20,8.954-20,20c0,11.046,8.954,20,20,20h423.557    l-70.162,69.824c-7.829,7.792-7.859,20.455-0.067,28.284c7.793,7.831,20.457,7.858,28.285,0.068l104.504-104    c0.006-0.006,0.011-0.013,0.018-0.019C513.968,262.339,513.943,249.635,506.134,241.843z">
                          </path>
                        </g>
                      </g>
                    </svg><img></span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="u-align-center u-clearfix u-palette-3-light-2 u-section-2" id="usuarios">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <div id="userContent">
        <h5 class="u-text">Lista de Usuários</h5><br><br>
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Nome</th>
              <th>WhatsApp</th>
            </tr>
          </thead>
          <tbody id="userTableBody">
            <!-- O JavaScript preencherá esta parte -->
          </tbody>
        </table>
      </div>
    </div>
  </section>

  <script>
    // Buscar /usuarios 
    fetch('/usuarios')
      .then(response => response.json())
      .then(data => {
        if (data.status && data.users.length > 0) {
          const tbody = document.getElementById('userTableBody');

          // Limpa qualquer linha pré-existente
          tbody.innerHTML = '';

          data.users.forEach(user => {
            const tr = document.createElement('tr');
            const tdId = document.createElement('td');
            const tdName = document.createElement('td');
            const tdWhatsApp = document.createElement('td');

            tdId.innerText = user.id;
            tdName.innerText = user.nome;
            tdWhatsApp.innerText = user.whatsapp;

            tr.appendChild(tdId);
            tr.appendChild(tdName);
            tr.appendChild(tdWhatsApp);

            tbody.appendChild(tr);
          });
        }
      });

  </script>

  <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-21de">
    <div class="u-clearfix u-sheet u-sheet-1">
      <p class="u-small-text u-text u-text-variant u-text-1"><a href="http://ia-z.online/">© IAZ 2023</a>
      </p>
    </div>
  </footer>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js" crossorigin="anonymous"></script>
  <script>
    $(document).ready(function () {
      var socket = io();

      // Função para pegar parâmetros da URL
      function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
          results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }

      // Pegar o ID da URL. Se não existir, usar 1 como padrão.
      const id = getParameterByName('id') || 1;

      // Buscar a instrução e usar o ID como nome da sala
      fetch('/instrucao/' + id)
        .then(response => {
          if (!response.ok) {
            throw new Error('Erro de rede');
          }
          return response.json();
        })
        .then(data => {
          document.getElementById('instructionTextArea').value = data.instruction;

          // Aqui, fazemos o socket entrar na sala com a instancia
          instancia = data.instancia;


          socket.emit('joinRoom', instancia);
        })
        .catch(error => {
          console.error('Erro ao buscar instrução:', error);
          toggleInstanceNameVisibility();
        });

      socket.on('message', function (msg) {
        $('.logs').append($('<li>').text(msg));
      });

      socket.on('qr', function (src) {
        $('#qrcode').attr('src', src);
        $('#qrcode').show();
      });

      socket.on('ready', function (data) {
        $('#qrcode').hide();
      });

      socket.on('authenticated', function (data) {
        $('#qrcode').hide();
      });
    });






    //$(document).ready(function () {
    //  var socket = io();
    //
    //  socket.on('message', function (msg) {
    //    $('.logs').append($('<li>').text(msg));
    //  });
    //
    //  socket.on('qr', function (src) {
    //    $('#qrcode').attr('src', src);
    //    $('#qrcode').show();
    //  });
    //
    //  socket.on('ready', function (data) {
    //    $('#qrcode').hide();
    //  });
    //
    //  socket.on('authenticated', function (data) {
    //    $('#qrcode').hide();
    //  });
    //});
  </script>
</body>

</html>
